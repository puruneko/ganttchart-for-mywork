# 協業ポリシー（COOPERATION POLICY）

この文書は、本プロジェクトにおける **協業・開発作業の基本ルール**を定義します。  
人間および 生成AI (rovodev / claudcode) の双方が遵守する前提です。

---

## 1. 基本方針

- コメントおよび説明文は **日本語**で記述すること
- スクリプト実行については **事前の許可は不要**
- 実装中の細かい進捗レスポンスは不要  
  → **ある程度進んだ段階でまとめて報告すること**

---

## 2. プロジェクト引き継ぎルール

- 開発プロジェクトの引き継ぎ情報は、以下を必ず確認すること
  - git の **commit メッセージ**
  - **documents配下の Markdown ファイル**
- 特に **ONBOARDING.md は必須確認**
  - 記載されている **引き継ぎチェックリストをすべて完了**させること

---

## 3. git 運用ルール

- **ファイル修正ごとに必ず commit を行う**
- commit メッセージを追うだけで、第三者が開発を引き継げるレベルを維持すること

---

## 4. コード変更とテストの必須条件

- コード変更を行う場合、**必ず全テストがパスした状態で提出すること**
- 以下を満たすまで作業は完了とみなさない

### 4.1 テスト実施の基本ルール

- テスト失敗を減らすため、**テスト実行前に影響範囲を事前確認する**
- **すべてのテストがパスするまで作業を完了としない**
- テストが失敗した場合は、
  - 必ず **原因を特定**
  - 修正を行い、再度すべてのテストを実行すること
- テストコードは **tests 配下**に作成する

---

## 5. UI テスト（Playwright / E2E）

- UI テストは **Playwright による E2E テストのみ許可**
  - 配置先：`tests/e2e`
  - 実行コマンド：`npm run test:e2e`

### 5.1 Playwright 実行ルール（重要）

- 開発サーバの起動は **Playwright の webServer 設定に完全に任せる**
  - `npm run dev` を手動で起動してはならない
- **サーバが起動している前提でテストを書かない**
- `baseURL` は **playwright.config.ts の設定のみを使用**
- `page.goto()` で以下を行うことは禁止
  - `localhost` の直接指定
  - ポート番号の直接指定
  - `waitUntil`に`networkidle`の指定は禁止。`domcontentloaded`を推奨
- サーバ起動失敗・ポート競合が発生した場合
  - **テストコードは修正しない**
  - 起動方法や設定を見直すこと
- テスト終了後は **使用したポートを必ず解放する**

### 5.2 UI テスト内容の制約

- **ユーザー操作を伴わない UI テストは禁止**
- UI テストは最低限、以下をカバーすること
  - 画面が表示されること
  - 主要操作（クリック・入力など）
  - 期待する結果が **DOM に反映されること**

---

## 6. クレジット消費に関する方針

- **rovodev のクレジット消費を最小限に抑えること**
- テスト失敗 → 修正 の回数は、可能な限り少なくする
- 私へのレスポンスは必要最低限とする
- 検証や試行錯誤は、可能な限り内部で完結させること

---

## 7. フェーズ制約

- 本ポリシーの理解のみを求められた場合、 **理解のみを行い、開発を開始しないこと**
- 本ポリシーの理解のみを求められた場合、 **以下の質問の回答のみ、はい/いいえでResponseすること**
  - ①COOPERATION_POLICY.mdの内用を理解しましたか？
  - ②ONBOARDING.mdの「開発の引き継ぎチェックリスト」をすべてパスしましたか？
